{% extends "app/base_site.html" %}

{% block title %} Webmaps {% endblock title %}


{% block stylesheets %}
    {{ block.super }}
    <style>
        .node {
            cursor: pointer;
        }

        .node circle {
            fill: #fff;
            stroke: #343a40;
            stroke-width: 1px;
        }

        .node text {
            font-size: 11px;
            fill: #3c3c3c;
        }

        .link {
            fill: none;
            stroke: #dcdcdc;
            stroke-width: 1px;
        }

        #viewDiv {
            height: 100%;
            width: 100%;
        }

        #chartd3 {
            height: 100%;
        }

        .d3chart {
            height: 400px;
        }
    </style>

{% endblock stylesheets %}

{% block content %}
    <div class="container body">
        <div class="right_col" role="main">
            <h1><a href={{ details.4.url }}>{{ details.4.name }}</a></h1>
            <h2>{{ details.4.type|striptags }}</h2>
            <div class="clearfix">
                <div class="row">
                    <div class="col-md-10 col-sm-10 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2><span class="fas fa-project-diagram"></span> What does this {{ details.4.name }}
                                    WebMap contain?</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fas fa-chevron-up"></i></a>
                                    </li>
                                    <li><a class="close-link"><i class="fas fa-times"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content d3chart">
                                <div id="chartd3"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-2 col-xs-12 col">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>Quick Stats<small></small></h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fas fa-chevron-up"></i></a>
                                    </li>
                                    <li><a class="close-link"><i class="fas fa-times"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <h3>{{ details.1|length }}</h3>
                                <small>Number of Map Services</small>
                                <h3>{{ details.2|length }}</h3>
                                <small>Number of Layers</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2><span class="fas fa-map-signs"></span> Web Services List</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fas fa-chevron-up"></i></a>
                                    </li>
                                    <li><a class="close-link"><i class="fas fa-times"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <table id="datatable-services" class="table table-striped table-bordered" width="100%">
                                    <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>URL</th>
                                        <th>Type</th>
                                        <th>Publishing Server</th>
                                        <th>GDB</th>
                                        <th>Instance</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for item in details.1 %}
                                        <tr>
                                            <td>{{ item.name }}</td>
                                            <td>{{ item.url }}</td>
                                            <td>{{ item.type }}</td>
                                            <td>{{ item.owner }}</td>
                                            <td>
                                                <ul>{% for db in item.database %}
                                                    <li>{{ db }}</li>
                                                {% endfor %}</ul>
                                            </td>
                                            <td>{{ item.instance }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2><span class="fas fa-layer-group"></span> Feature Class List</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fas fa-chevron-up"></i></a>
                                    </li>
                                    <li><a class="close-link"><i class="fas fa-times"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <table id="datatable-layers" class="table table-striped table-bordered" width="100%">
                                    <thead>
                                    <tr>
                                        <th class="details">Details</th>
                                        <th>Name</th>
                                        <th>Service</th>
                                        <th>Database</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for item in details.2 %}
                                        <tr>
                                            <td>
                                                <a href="/layer/{{ item.name }}/">
                                                    <button class="btn btn-secondary badge badge-dark">More
                                                        Information
                                                    </button>
                                                </a></td>
                                            <td><a href="/layer/{{ item.name }}/">{{ item.name }}</a></td>
                                            <td>{{ item.url }}</td>
                                            <td>{{ item.database }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="row">
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="x_panel">
                        <div class="x_title">
                            <h2><span class="far fa-list-alt"></span> Alternative Dependency</h2>
                            <ul class="nav navbar-right panel_toolbox">
                                <li><a class="collapse-link"><i class="fas fa-chevron-up"></i></a>
                                </li>
                                <li><a class="close-link"><i class="fas fa-times"></i></a>
                                </li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                            <ul>
                                {% for alt in details.3 %}
                                    <pre>{{ alt }}</pre>
                                {% endfor %}
                            </ul>
                        </div>

                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
{% endblock content %}

{% block javascripts %}
    {{ block.super }}
    <script src="https://cdn.jsdelivr.net/npm/d3@3.0.0/d3.min.js"
            integrity="sha256-b69VTDu5tPmoLspoBD0rxTFiimxoTONDLrAgF68zU8c=" crossorigin="anonymous"></script>

    {{ details.0|json_script:"d3data" }}
    <script type="text/javascript" src="/static/build/js/d3chart.js"></script>

{% endblock javascripts %}