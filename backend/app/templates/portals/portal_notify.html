<!-- Licensed under GPLv3 - See LICENSE file for details. -->
<calcite-dialog id="notify-modal" modal heading="Notify" scale="m"
                {% if form.errors %}kind="danger"{% endif %}>
<calcite-stepper id="notify-stepper" layout="horizontal" scale="s">
      <calcite-stepper-item heading="Select items" selected>
        <form id="notify-portal-form" class="calcite-form" autocomplete="off">
      {% csrf_token %}
      <input type="hidden" name="selected_maps" id="selected-maps">
      <input type="hidden" name="selected_apps" id="selected-apps">

      <calcite-label>Affected Maps</calcite-label>
      <calcite-table id="maps-table" scale="s" caption="Maps" striped selection-mode="multiple" page-size="10" bordered>
        <calcite-table-row slot="table-header">
          <calcite-table-header heading="Title"></calcite-table-header>
          <calcite-table-header heading="Owner"></calcite-table-header>
        </calcite-table-row>
        {% for map in maps %}
          <calcite-table-row data-id="{{ map.webmap_id }}">
            <calcite-table-cell>{{ map.webmap_title }}</calcite-table-cell>
            <calcite-table-cell>{{ map.webmap_owner }}</calcite-table-cell>
          </calcite-table-row>
        {% endfor %}
      </calcite-table>

      <calcite-label>Affected Apps</calcite-label>
      <calcite-table id="apps-table" scale="s" caption="Apps" striped selection-mode="multiple" page-size="10" bordered>
        <calcite-table-row slot="table-header">
          <calcite-table-header heading="Title"></calcite-table-header>
          <calcite-table-header heading="Owner"></calcite-table-header>
        </calcite-table-row>
        {% for app in apps %}
          <calcite-table-row data-id="{{ app.app_id }}">
            <calcite-table-cell>{{ app.app_title }}</calcite-table-cell>
            <calcite-table-cell>{{ app.app_owner }}</calcite-table-cell>
          </calcite-table-row>
        {% endfor %}
      </calcite-table>
    </form>
      </calcite-stepper-item>
  <calcite-stepper-item heading="Add info">
        <calcite-label>Provide additional information about the change
        <calcite-text-area id="change-text" value="This email is to inform you about upcoming changes to the {% if item.layer_name %}{{ item.layer_name }} layer. {% elif item.service_name %}{{ item.service_name }} service. {% endif %}Below is content you own that may be impacted by this change. For additional information, question or concerns please contact your portal administrator."
                            rows=4></calcite-text-area>
      </calcite-label>
      </calcite-stepper-item>
</calcite-stepper>

  <calcite-button id="notify-portal-cancel" data-action="close-modal" slot="footer-end" appearance="outline" icon-start="circle-disallowed">
    Cancel
  </calcite-button>

  <calcite-button id="notify-portal-save" slot="footer-end"
                  icon-start="chevron-right" hx-post="{% url 'enterpriseviz:notify' %}"
                  hx-target="#notify-portal-form" hx-include="#notify-portal-form">
    Next
  </calcite-button>

</calcite-dialog>
