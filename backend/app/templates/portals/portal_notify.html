<!-- Licensed under GPLv3 - See LICENSE file for details. -->
<calcite-dialog id="notify-modal" modal heading="Notify" scale="m">
  <form id="notify-portal-form" class="calcite-form" autocomplete="off"
        hx-post="{% url 'enterpriseviz:notify' %}"
        hx-target="this"
        hx-swap="outerHTML">
    {% csrf_token %}
    <input type="hidden" name="selected_maps" id="selected-maps">
    <input type="hidden" name="selected_apps" id="selected-apps">

    <calcite-stepper id="notify-stepper" layout="horizontal" scale="s">
      <calcite-stepper-item heading="Select items" selected>
        <calcite-label>Affected Maps</calcite-label>
        <calcite-table id="maps-table" scale="s" caption="Maps" striped selection-mode="multiple" page-size="10"
                       bordered>
          <calcite-table-row slot="table-header">
            <calcite-table-header heading="Title"></calcite-table-header>
            <calcite-table-header heading="Owner"></calcite-table-header>
          </calcite-table-row>
          {% for map in maps %}
            <calcite-table-row data-id="{{ map.webmap_id }}">
              <calcite-table-cell>{{ map.webmap_title }}</calcite-table-cell>
              <calcite-table-cell>{{ map.webmap_owner }}</calcite-table-cell>
            </calcite-table-row>
          {% endfor %}
        </calcite-table>

        <calcite-label>Affected Apps</calcite-label>
        <calcite-table id="apps-table" scale="s" caption="Apps" striped selection-mode="multiple" page-size="10"
                       bordered>
          <calcite-table-row slot="table-header">
            <calcite-table-header heading="Title"></calcite-table-header>
            <calcite-table-header heading="Owner"></calcite-table-header>
          </calcite-table-row>
          {% for app in apps %}
            <calcite-table-row data-id="{{ app.app_id }}">
              <calcite-table-cell>{{ app.app_title }}</calcite-table-cell>
              <calcite-table-cell>{{ app.app_owner }}</calcite-table-cell>
            </calcite-table-row>
          {% endfor %}
        </calcite-table>
      </calcite-stepper-item>

      <calcite-stepper-item heading="Add info">
        <calcite-label>Provide additional information about the change
          <calcite-text-area name="change" id="change-text"
                             rows="4">This email is to inform you about upcoming changes to the '{{ change_item_name }}' layer. Below is content you own that may be impacted by this change. For additional information, questions, or concerns, please contact your portal administrator.
          </calcite-text-area>
        </calcite-label>
      </calcite-stepper-item>
    </calcite-stepper>
  </form>

  <calcite-button id="notify-portal-cancel" data-action="close-modal" slot="footer-end" appearance="outline"
                  icon-start="circle-disallowed">
    Cancel
  </calcite-button>

  <calcite-button id="notify-portal-save" slot="footer-end"
                  icon-start="chevron-right">
    Next
  </calcite-button>
</calcite-dialog>
